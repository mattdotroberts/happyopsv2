---
import FeatureBox from './FeatureBox.astro';

const features = [
  {
    label: "Workshops & Training",
    headline: "We Teach",
    description: "Practical AI and automation training that transforms your team. Hands-on workshops tailored to your industry.",
    href: "/workshops",
    linkText: "View Workshops"
  },
  {
    label: "Client Projects",
    headline: "We Build",
    description: "Custom automation systems that save hundreds of hours. From strategy to implementation.",
    href: "/case-study",
    linkText: "See Case Study"
  },
  {
    label: "Our Product",
    headline: "We Ship",
    description: "Hapi â€” AI-powered transcription for macOS. Built by operators, for operators.",
    href: "https://hapi.so",
    linkText: "Try Hapi",
    external: true
  }
];
---

<section class="feature-stack">
  {features.map((feature) => (
    <FeatureBox
      label={feature.label}
      headline={feature.headline}
      description={feature.description}
      href={feature.href}
      linkText={feature.linkText}
      external={feature.external}
    />
  ))}
</section>

<script>
  // Scroll-based expansion animation for feature boxes
  const featureWrappers = document.querySelectorAll('.feature-box-wrapper');

  if (featureWrappers.length > 0) {
    const observerOptions = {
      threshold: 0.3,
      rootMargin: '-10% 0px -10% 0px'
    };

    const featureObserver = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('expanded');
        } else {
          // Remove expanded state when scrolling away
          entry.target.classList.remove('expanded');
        }
      });
    }, observerOptions);

    featureWrappers.forEach((wrapper) => {
      featureObserver.observe(wrapper);
    });
  }
</script>

<style>
  .feature-stack {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
    padding: var(--space-2xl) 0;
  }

  @media (max-width: 768px) {
    .feature-stack {
      gap: var(--space-md);
      padding: var(--space-xl) 0;
    }
  }
</style>
